<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My MLS Team's Odds</title>
</head>
<body style="background-color:white;">
  <h1 style="font-size:75px; color:black;">Live Sports Odds</h1>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
      <header>
          <nav class="navbar navbar-expand-lg">
              <div class="container-fluid">
                
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                      <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="about.html">About Our Project</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="sports.html">Sport Betting</a>
                    </li>
                    
                </div>
             
            </nav>
        </header>




        <br><br>
  

        <h3>Inputs "work in progress - Sorin"</h3>



    <div>
        <label>The Odds API Key:</label>
        <input type="text" name="api-key" id="my-api-key" placeholder="Betting API Key" value="e72f1251b3be1811c37ed5e6daa2519f">
        <br>

        <label>Your Favorite MLS Team:</label>
        <select id="my-team-selector">
            <option value="DC United" selected>DC United</option>            
            <option value="Atlanta United FC"> Atlanta United FC</option>            
            <option value='Chicago Fire FC'>Chicago Fire FC</option>
            <option value='FC Cincinnati'>FC Cincinnati</option>
            <option value='Columbus Crew SC'>Columbus Crew SC</option>
            <option value='Inter Miami CF'>Inter Miami CF</option>
            <option value='CF Montréal'>CF Montréal</option>
            <option value='Nashville SC'>Nashville SC</option>
            <option value='New England Revolution'>New England Revolution</option>
            <option value='New York City FC'>New York City FC</option>
            <option value='New York Red Bulls'>New York Red Bulls</option>
            <option value='Orlando City SC'>Orlando City SC</option>
            <option value='Philadelphia Union'>Philadelphia Union</option>
            <option value='Toronto FC'>Toronto FC</option>
            <option value='Austin FC'>Austin FC</option>
            <option value='Colorado Rapids'>Colorado Rapids</option>
            <option value='FC Dallas'>FC Dallas</option>
            <option value='Houston Dynamo FC'>Houston Dynamo FC</option>
            <option value='Sporting Kansas City'>Sporting Kansas City</option>
            <option value='LA Galaxy'>LA Galaxy</option>
            <option value='Los Angeles FC'>Los Angeles FC</option>
            <option value='Minnesota United FC'>Minnesota United FC</option>
            <option value='Portland Timbers'>Portland Timbers</option>
            <option value='Real Salt Lake'>Real Salt Lake</option>
            <option value='San Jose Earthquakes'>San Jose Earthquakes</option>
            <option value='Seattle Sounders FC'>Seattle Sounders FC</option>
            <option value='Vancouver Whitecaps FC'>Vancouver Whitecaps FC</option>

        </select>
        <br>

        <button id="my-submit-btn">Go!</button>
    </div>

    <hr>

    <h2>Outputs</h2>

    <div>
        <p>Selected Team: <span id="display-team">_____________</span></p>
        <p>Latest Odds: <span id="display-latest-odds">__________</span></p>
    </div>

    <div id="dataviz-container"></div>

    
    <script type="text/javascript">

        //
        // When the button is clicked:
        // ... 1) capture input values
        // ... 2) compile the right URL given the provided inputs
        // ... 3) fetch data from that URL
        // ... 4) crunch the data
        // ... 5) overwrite the HTML display values (team, latest close)
        // ... 6) make a dataviz
        //
        var team, apiKey, playing_teams, closingPrices;
        var inputApiKey = document.getElementById("my-api-key");
        var inputSelect = document.getElementById("my-team-selector");
        document.getElementById("my-submit-btn").onclick = function() {
            team = inputSelect.value;
            document.getElementById("display-team").innerHTML = team;
            

            apiKey = inputApiKey.value;
            document.getElementById("display-latest-odds").innerHTML = "TBU";

            //var requestUrl = "https://api.the-odds-api.com/v3/odds/?sport=soccer_usa_mls&region=us&mkt=h2h&dateFormat=iso" +"&apiKey=" + apiKey
            var requestUrl = "https://api.the-odds-api.com/v3/odds/?sport=soccer_usa_mls&region=us&mkt=h2h&dateFormat=iso&apiKey=e72f1251b3be1811c37ed5e6daa2519f"
            console.log("REQUEST URL:", requestUrl);
            fetch(requestUrl)
                .then(response => {
                    console.log("RESPONSE", response)
                    return response.json()
                })
                .then(data => {
                    //console.log("DATA", data) // this is the data you're looking for
                    playing_teams = Object.keys(data["teams"]);
                    var priceData = Object.values(data["teams"]);
                    //closingPrices = priceData.map(x => x["4. close"]);
                    //console.log(closingPrices);
                    document.getElementById("display-latest-odds").innerHTML = playing_teams;
                    //var trace1 = {
                    //    x: playing_teams,
                    //    y: closingPrices,
                    //    mode: 'lines'
                    //};                   

                    //var data = [ trace1 ];

                    //var layout = {
                        title:'Closing prices of ' + team
                    //};

                    //Plotly.newPlot('dataviz-container', data, layout);
                })
                .catch(err => {
                    console.error("FETCH ERR", err)
                })

        };
        

        //console.log("TODO: RESPOND TO BUTTON CLICKS AND CAPTURE FORM INPUTS")

        //var apiKey = "TODO"
        //var team = "TODO"
        var requestUrl = "https://api.the-odds-api.com/v3/odds/?sport=soccer_usa_mls&region=us&mkt=h2h&dateFormat=iso&apiKey=e72f1251b3be1811c37ed5e6daa2519f"
        console.log("REQUEST URL:", requestUrl)

        //console.log("TODO: FETCH DATA")

        //console.log("TODO: DISPLAY DATA")

        //console.log("TODO: DATAVIZ")

    </script>
</body>
</html>

